/home/schfrst2/creole_nn/creole/neural_stacking/model.py:54: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greately increasing memory usage. To compact weights again call flatten_parameters().
  output, hidden = self.rnn(emb, hidden)
Finetuning model on ht
| epoch   1 |   200/ 3131 batches | lr 20.00 | ms/batch 58.91 | loss  4.64 | ppl   103.09
| epoch   1 |   400/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  1.99 | ppl     7.32
| epoch   1 |   600/ 3131 batches | lr 20.00 | ms/batch 36.48 | loss  1.82 | ppl     6.14
| epoch   1 |   800/ 3131 batches | lr 20.00 | ms/batch 36.42 | loss  1.77 | ppl     5.88
| epoch   1 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.35 | loss  1.64 | ppl     5.14
| epoch   1 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.66 | loss  1.36 | ppl     3.89
| epoch   1 |  1400/ 3131 batches | lr 20.00 | ms/batch 37.03 | loss  1.57 | ppl     4.83
| epoch   1 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.38 | loss  1.61 | ppl     5.00
| epoch   1 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.04 | loss  1.55 | ppl     4.72
| epoch   1 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.54 | loss  1.35 | ppl     3.85
| epoch   1 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  1.27 | ppl     3.56
| epoch   1 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.94 | loss  1.34 | ppl     3.81
| epoch   1 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.31 | loss  1.35 | ppl     3.85
| epoch   1 |  2800/ 3131 batches | lr 20.00 | ms/batch 37.05 | loss  1.18 | ppl     3.26
| epoch   1 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.77 | loss  1.23 | ppl     3.44
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 124.79s | valid loss  1.55 | valid ppl     4.72
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 3131 batches | lr 20.00 | ms/batch 36.88 | loss  1.29 | ppl     3.62
| epoch   2 |   400/ 3131 batches | lr 20.00 | ms/batch 36.54 | loss  1.15 | ppl     3.17
| epoch   2 |   600/ 3131 batches | lr 20.00 | ms/batch 36.33 | loss  1.11 | ppl     3.04
| epoch   2 |   800/ 3131 batches | lr 20.00 | ms/batch 37.31 | loss  1.15 | ppl     3.17
| epoch   2 |  1000/ 3131 batches | lr 20.00 | ms/batch 37.92 | loss  1.09 | ppl     2.97
| epoch   2 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.91 | ppl     2.49
| epoch   2 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.57 | loss  1.09 | ppl     2.97
| epoch   2 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.31 | loss  1.16 | ppl     3.18
| epoch   2 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  1.13 | ppl     3.08
| epoch   2 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.62 | loss  1.00 | ppl     2.71
| epoch   2 |  2200/ 3131 batches | lr 20.00 | ms/batch 37.95 | loss  0.92 | ppl     2.51
| epoch   2 |  2400/ 3131 batches | lr 20.00 | ms/batch 37.62 | loss  1.00 | ppl     2.71
| epoch   2 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.15 | loss  1.00 | ppl     2.71
| epoch   2 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  0.86 | ppl     2.36
| epoch   2 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.52 | loss  0.93 | ppl     2.53
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 120.65s | valid loss  1.18 | valid ppl     3.27
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 3131 batches | lr 20.00 | ms/batch 36.45 | loss  0.99 | ppl     2.68
| epoch   3 |   400/ 3131 batches | lr 20.00 | ms/batch 36.19 | loss  0.90 | ppl     2.46
| epoch   3 |   600/ 3131 batches | lr 20.00 | ms/batch 36.35 | loss  0.87 | ppl     2.38
| epoch   3 |   800/ 3131 batches | lr 20.00 | ms/batch 36.42 | loss  0.91 | ppl     2.48
| epoch   3 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.45 | loss  0.86 | ppl     2.37
| epoch   3 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.44 | loss  0.73 | ppl     2.07
| epoch   3 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.49 | loss  0.88 | ppl     2.40
| epoch   3 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.51 | loss  0.95 | ppl     2.58
| epoch   3 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.54 | loss  0.92 | ppl     2.51
| epoch   3 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.52 | loss  0.82 | ppl     2.27
| epoch   3 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.58 | loss  0.75 | ppl     2.12
| epoch   3 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.63 | loss  0.82 | ppl     2.27
| epoch   3 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.47 | loss  0.81 | ppl     2.26
| epoch   3 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  0.69 | ppl     1.99
| epoch   3 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.49 | loss  0.76 | ppl     2.13
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 119.92s | valid loss  0.97 | valid ppl     2.64
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 3131 batches | lr 20.00 | ms/batch 36.38 | loss  0.80 | ppl     2.23
| epoch   4 |   400/ 3131 batches | lr 20.00 | ms/batch 36.23 | loss  0.74 | ppl     2.10
| epoch   4 |   600/ 3131 batches | lr 20.00 | ms/batch 36.79 | loss  0.71 | ppl     2.04
| epoch   4 |   800/ 3131 batches | lr 20.00 | ms/batch 36.46 | loss  0.75 | ppl     2.12
| epoch   4 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.43 | loss  0.71 | ppl     2.04
| epoch   4 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.46 | loss  0.60 | ppl     1.83
| epoch   4 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.90 | loss  0.73 | ppl     2.08
| epoch   4 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.98 | loss  0.80 | ppl     2.24
| epoch   4 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.90 | loss  0.78 | ppl     2.18
| epoch   4 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.54 | loss  0.69 | ppl     2.00
| epoch   4 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  0.63 | ppl     1.89
| epoch   4 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.53 | loss  0.70 | ppl     2.01
| epoch   4 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.76 | loss  0.69 | ppl     1.99
| epoch   4 |  2800/ 3131 batches | lr 20.00 | ms/batch 37.09 | loss  0.58 | ppl     1.78
| epoch   4 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.59 | loss  0.64 | ppl     1.89
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 120.08s | valid loss  0.83 | valid ppl     2.29
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 3131 batches | lr 20.00 | ms/batch 36.00 | loss  0.67 | ppl     1.96
| epoch   5 |   400/ 3131 batches | lr 20.00 | ms/batch 36.46 | loss  0.63 | ppl     1.88
| epoch   5 |   600/ 3131 batches | lr 20.00 | ms/batch 36.36 | loss  0.60 | ppl     1.82
| epoch   5 |   800/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.63 | ppl     1.89
| epoch   5 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.20 | loss  0.60 | ppl     1.83
| epoch   5 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.00 | loss  0.51 | ppl     1.66
| epoch   5 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.67 | loss  0.63 | ppl     1.87
| epoch   5 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.04 | loss  0.69 | ppl     2.00
| epoch   5 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.54 | loss  0.67 | ppl     1.95
| epoch   5 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.80 | loss  0.60 | ppl     1.82
| epoch   5 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.45 | loss  0.55 | ppl     1.73
| epoch   5 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.69 | loss  0.61 | ppl     1.83
| epoch   5 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.56 | loss  0.60 | ppl     1.82
| epoch   5 |  2800/ 3131 batches | lr 20.00 | ms/batch 37.46 | loss  0.50 | ppl     1.65
| epoch   5 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.50 | loss  0.55 | ppl     1.73
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 119.98s | valid loss  0.73 | valid ppl     2.08
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 3131 batches | lr 20.00 | ms/batch 35.98 | loss  0.57 | ppl     1.77
| epoch   6 |   400/ 3131 batches | lr 20.00 | ms/batch 36.33 | loss  0.53 | ppl     1.71
| epoch   6 |   600/ 3131 batches | lr 20.00 | ms/batch 36.64 | loss  0.51 | ppl     1.66
| epoch   6 |   800/ 3131 batches | lr 20.00 | ms/batch 36.42 | loss  0.54 | ppl     1.71
| epoch   6 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.70 | loss  0.51 | ppl     1.67
| epoch   6 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.49 | loss  0.44 | ppl     1.55
| epoch   6 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.10 | loss  0.54 | ppl     1.72
| epoch   6 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.16 | loss  0.61 | ppl     1.84
| epoch   6 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.31 | loss  0.58 | ppl     1.79
| epoch   6 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.17 | loss  0.52 | ppl     1.68
| epoch   6 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.66 | loss  0.48 | ppl     1.61
| epoch   6 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.76 | loss  0.53 | ppl     1.70
| epoch   6 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.40 | loss  0.53 | ppl     1.69
| epoch   6 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.70 | loss  0.43 | ppl     1.54
| epoch   6 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  0.47 | ppl     1.60
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 119.83s | valid loss  0.65 | valid ppl     1.92
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 3131 batches | lr 20.00 | ms/batch 36.42 | loss  0.49 | ppl     1.63
| epoch   7 |   400/ 3131 batches | lr 20.00 | ms/batch 36.36 | loss  0.46 | ppl     1.58
| epoch   7 |   600/ 3131 batches | lr 20.00 | ms/batch 35.03 | loss  0.44 | ppl     1.55
| epoch   7 |   800/ 3131 batches | lr 20.00 | ms/batch 36.54 | loss  0.47 | ppl     1.59
| epoch   7 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.42 | loss  0.44 | ppl     1.56
| epoch   7 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.38 | ppl     1.46
| epoch   7 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.48 | loss  0.47 | ppl     1.60
| epoch   7 |  1600/ 3131 batches | lr 20.00 | ms/batch 37.13 | loss  0.53 | ppl     1.70
| epoch   7 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.18 | loss  0.50 | ppl     1.66
| epoch   7 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.79 | loss  0.45 | ppl     1.57
| epoch   7 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.69 | loss  0.42 | ppl     1.52
| epoch   7 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.50 | loss  0.47 | ppl     1.60
| epoch   7 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.46 | ppl     1.59
| epoch   7 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.70 | loss  0.38 | ppl     1.46
| epoch   7 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.59 | loss  0.41 | ppl     1.51
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 119.88s | valid loss  0.58 | valid ppl     1.78
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.42 | ppl     1.52
| epoch   8 |   400/ 3131 batches | lr 20.00 | ms/batch 36.23 | loss  0.39 | ppl     1.48
| epoch   8 |   600/ 3131 batches | lr 20.00 | ms/batch 36.56 | loss  0.38 | ppl     1.46
| epoch   8 |   800/ 3131 batches | lr 20.00 | ms/batch 36.58 | loss  0.40 | ppl     1.50
| epoch   8 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.44 | loss  0.38 | ppl     1.47
| epoch   8 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.84 | loss  0.33 | ppl     1.39
| epoch   8 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.64 | loss  0.41 | ppl     1.51
| epoch   8 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.47 | loss  0.47 | ppl     1.59
| epoch   8 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.34 | loss  0.44 | ppl     1.56
| epoch   8 |  2000/ 3131 batches | lr 20.00 | ms/batch 37.65 | loss  0.40 | ppl     1.49
| epoch   8 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.37 | ppl     1.44
| epoch   8 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.52 | loss  0.42 | ppl     1.52
| epoch   8 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.28 | loss  0.41 | ppl     1.51
| epoch   8 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  0.34 | ppl     1.40
| epoch   8 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.76 | loss  0.36 | ppl     1.43
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 120.38s | valid loss  0.52 | valid ppl     1.68
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 3131 batches | lr 20.00 | ms/batch 36.33 | loss  0.37 | ppl     1.44
| epoch   9 |   400/ 3131 batches | lr 20.00 | ms/batch 36.18 | loss  0.34 | ppl     1.41
| epoch   9 |   600/ 3131 batches | lr 20.00 | ms/batch 36.81 | loss  0.33 | ppl     1.39
| epoch   9 |   800/ 3131 batches | lr 20.00 | ms/batch 36.78 | loss  0.35 | ppl     1.42
| epoch   9 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.01 | loss  0.34 | ppl     1.40
| epoch   9 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.19 | loss  0.29 | ppl     1.34
| epoch   9 |  1400/ 3131 batches | lr 20.00 | ms/batch 37.52 | loss  0.36 | ppl     1.43
| epoch   9 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.60 | loss  0.41 | ppl     1.51
| epoch   9 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.54 | loss  0.39 | ppl     1.47
| epoch   9 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.79 | loss  0.35 | ppl     1.42
| epoch   9 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.79 | loss  0.33 | ppl     1.39
| epoch   9 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.35 | loss  0.37 | ppl     1.45
| epoch   9 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.46 | loss  0.36 | ppl     1.44
| epoch   9 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.63 | loss  0.30 | ppl     1.35
| epoch   9 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.32 | ppl     1.37
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 120.14s | valid loss  0.47 | valid ppl     1.60
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  0.32 | ppl     1.38
| epoch  10 |   400/ 3131 batches | lr 20.00 | ms/batch 36.37 | loss  0.30 | ppl     1.35
| epoch  10 |   600/ 3131 batches | lr 20.00 | ms/batch 36.50 | loss  0.29 | ppl     1.34
| epoch  10 |   800/ 3131 batches | lr 20.00 | ms/batch 36.17 | loss  0.31 | ppl     1.36
| epoch  10 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.38 | loss  0.29 | ppl     1.34
| epoch  10 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  0.26 | ppl     1.30
| epoch  10 |  1400/ 3131 batches | lr 20.00 | ms/batch 38.44 | loss  0.32 | ppl     1.38
| epoch  10 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.44 | loss  0.37 | ppl     1.44
| epoch  10 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.89 | loss  0.34 | ppl     1.41
| epoch  10 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.76 | loss  0.31 | ppl     1.37
| epoch  10 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.25 | loss  0.29 | ppl     1.34
| epoch  10 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.67 | loss  0.33 | ppl     1.39
| epoch  10 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.59 | loss  0.33 | ppl     1.39
| epoch  10 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.50 | loss  0.27 | ppl     1.31
| epoch  10 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.15 | loss  0.28 | ppl     1.32
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 120.39s | valid loss  0.44 | valid ppl     1.55
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 3131 batches | lr 20.00 | ms/batch 36.45 | loss  0.29 | ppl     1.33
| epoch  11 |   400/ 3131 batches | lr 20.00 | ms/batch 36.36 | loss  0.27 | ppl     1.31
| epoch  11 |   600/ 3131 batches | lr 20.00 | ms/batch 36.65 | loss  0.26 | ppl     1.30
| epoch  11 |   800/ 3131 batches | lr 20.00 | ms/batch 36.44 | loss  0.28 | ppl     1.32
| epoch  11 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  0.26 | ppl     1.30
| epoch  11 |  1200/ 3131 batches | lr 20.00 | ms/batch 37.39 | loss  0.23 | ppl     1.26
| epoch  11 |  1400/ 3131 batches | lr 20.00 | ms/batch 37.24 | loss  0.28 | ppl     1.33
| epoch  11 |  1600/ 3131 batches | lr 20.00 | ms/batch 35.63 | loss  0.32 | ppl     1.38
| epoch  11 |  1800/ 3131 batches | lr 20.00 | ms/batch 35.50 | loss  0.30 | ppl     1.35
| epoch  11 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.85 | loss  0.28 | ppl     1.32
| epoch  11 |  2200/ 3131 batches | lr 20.00 | ms/batch 37.21 | loss  0.26 | ppl     1.30
| epoch  11 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.39 | loss  0.30 | ppl     1.34
| epoch  11 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.65 | loss  0.29 | ppl     1.34
| epoch  11 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.18 | loss  0.24 | ppl     1.28
| epoch  11 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  0.25 | ppl     1.28
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 120.26s | valid loss  0.39 | valid ppl     1.48
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 3131 batches | lr 20.00 | ms/batch 36.48 | loss  0.26 | ppl     1.29
| epoch  12 |   400/ 3131 batches | lr 20.00 | ms/batch 36.27 | loss  0.24 | ppl     1.27
| epoch  12 |   600/ 3131 batches | lr 20.00 | ms/batch 36.58 | loss  0.24 | ppl     1.27
| epoch  12 |   800/ 3131 batches | lr 20.00 | ms/batch 36.61 | loss  0.25 | ppl     1.28
| epoch  12 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.66 | loss  0.23 | ppl     1.26
| epoch  12 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.16 | loss  0.21 | ppl     1.23
| epoch  12 |  1400/ 3131 batches | lr 20.00 | ms/batch 37.26 | loss  0.25 | ppl     1.29
| epoch  12 |  1600/ 3131 batches | lr 20.00 | ms/batch 37.01 | loss  0.29 | ppl     1.34
| epoch  12 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.57 | loss  0.27 | ppl     1.31
| epoch  12 |  2000/ 3131 batches | lr 20.00 | ms/batch 37.00 | loss  0.25 | ppl     1.28
| epoch  12 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.59 | loss  0.24 | ppl     1.27
| epoch  12 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.63 | loss  0.27 | ppl     1.31
| epoch  12 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.45 | loss  0.26 | ppl     1.30
| epoch  12 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.76 | loss  0.22 | ppl     1.25
| epoch  12 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.82 | loss  0.23 | ppl     1.25
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 120.60s | valid loss  0.37 | valid ppl     1.45
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 3131 batches | lr 20.00 | ms/batch 36.59 | loss  0.23 | ppl     1.26
| epoch  13 |   400/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  0.22 | ppl     1.24
| epoch  13 |   600/ 3131 batches | lr 20.00 | ms/batch 36.78 | loss  0.22 | ppl     1.24
| epoch  13 |   800/ 3131 batches | lr 20.00 | ms/batch 36.56 | loss  0.22 | ppl     1.25
| epoch  13 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.65 | loss  0.21 | ppl     1.24
| epoch  13 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.96 | loss  0.19 | ppl     1.21
| epoch  13 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.81 | loss  0.23 | ppl     1.26
| epoch  13 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.64 | loss  0.26 | ppl     1.30
| epoch  13 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.51 | loss  0.24 | ppl     1.27
| epoch  13 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.76 | loss  0.22 | ppl     1.25
| epoch  13 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.52 | loss  0.22 | ppl     1.24
| epoch  13 |  2400/ 3131 batches | lr 20.00 | ms/batch 35.75 | loss  0.24 | ppl     1.28
| epoch  13 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.58 | loss  0.24 | ppl     1.27
| epoch  13 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.63 | loss  0.20 | ppl     1.22
| epoch  13 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.64 | loss  0.20 | ppl     1.23
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 120.47s | valid loss  0.34 | valid ppl     1.40
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 3131 batches | lr 20.00 | ms/batch 36.30 | loss  0.21 | ppl     1.24
| epoch  14 |   400/ 3131 batches | lr 20.00 | ms/batch 36.39 | loss  0.20 | ppl     1.22
| epoch  14 |   600/ 3131 batches | lr 20.00 | ms/batch 36.36 | loss  0.20 | ppl     1.23
| epoch  14 |   800/ 3131 batches | lr 20.00 | ms/batch 37.01 | loss  0.20 | ppl     1.23
| epoch  14 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.74 | loss  0.19 | ppl     1.21
| epoch  14 |  1200/ 3131 batches | lr 20.00 | ms/batch 37.09 | loss  0.18 | ppl     1.19
| epoch  14 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.55 | loss  0.21 | ppl     1.23
| epoch  14 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.44 | loss  0.24 | ppl     1.27
| epoch  14 |  1800/ 3131 batches | lr 20.00 | ms/batch 37.36 | loss  0.22 | ppl     1.25
| epoch  14 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.57 | loss  0.20 | ppl     1.22
| epoch  14 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.93 | loss  0.20 | ppl     1.22
| epoch  14 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.65 | loss  0.22 | ppl     1.25
| epoch  14 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  0.22 | ppl     1.25
| epoch  14 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.43 | loss  0.18 | ppl     1.20
| epoch  14 |  3000/ 3131 batches | lr 20.00 | ms/batch 37.71 | loss  0.19 | ppl     1.20
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 120.75s | valid loss  0.32 | valid ppl     1.37
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 3131 batches | lr 20.00 | ms/batch 36.50 | loss  0.19 | ppl     1.21
| epoch  15 |   400/ 3131 batches | lr 20.00 | ms/batch 36.28 | loss  0.18 | ppl     1.20
| epoch  15 |   600/ 3131 batches | lr 20.00 | ms/batch 36.70 | loss  0.19 | ppl     1.20
| epoch  15 |   800/ 3131 batches | lr 20.00 | ms/batch 36.38 | loss  0.19 | ppl     1.21
| epoch  15 |  1000/ 3131 batches | lr 20.00 | ms/batch 37.08 | loss  0.18 | ppl     1.20
| epoch  15 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.74 | loss  0.16 | ppl     1.18
| epoch  15 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.66 | loss  0.19 | ppl     1.21
| epoch  15 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.86 | loss  0.22 | ppl     1.24
| epoch  15 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.67 | loss  0.20 | ppl     1.22
| epoch  15 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.66 | loss  0.19 | ppl     1.20
| epoch  15 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.63 | loss  0.18 | ppl     1.20
| epoch  15 |  2400/ 3131 batches | lr 20.00 | ms/batch 37.17 | loss  0.20 | ppl     1.22
| epoch  15 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.48 | loss  0.20 | ppl     1.22
| epoch  15 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.25 | loss  0.17 | ppl     1.18
| epoch  15 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.12 | loss  0.17 | ppl     1.19
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 120.20s | valid loss  0.31 | valid ppl     1.36
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 3131 batches | lr 20.00 | ms/batch 37.51 | loss  0.18 | ppl     1.20
| epoch  16 |   400/ 3131 batches | lr 20.00 | ms/batch 36.99 | loss  0.17 | ppl     1.19
| epoch  16 |   600/ 3131 batches | lr 20.00 | ms/batch 36.67 | loss  0.18 | ppl     1.19
| epoch  16 |   800/ 3131 batches | lr 20.00 | ms/batch 36.76 | loss  0.18 | ppl     1.20
| epoch  16 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.85 | loss  0.17 | ppl     1.19
| epoch  16 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.97 | loss  0.16 | ppl     1.17
| epoch  16 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.59 | loss  0.18 | ppl     1.20
| epoch  16 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.67 | loss  0.20 | ppl     1.22
| epoch  16 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.77 | loss  0.19 | ppl     1.20
| epoch  16 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.50 | loss  0.17 | ppl     1.18
| epoch  16 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.82 | loss  0.17 | ppl     1.18
| epoch  16 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.50 | loss  0.19 | ppl     1.21
| epoch  16 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.71 | loss  0.19 | ppl     1.21
| epoch  16 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.52 | loss  0.16 | ppl     1.18
| epoch  16 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.97 | loss  0.16 | ppl     1.17
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 121.08s | valid loss  0.28 | valid ppl     1.33
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 3131 batches | lr 20.00 | ms/batch 36.45 | loss  0.17 | ppl     1.19
| epoch  17 |   400/ 3131 batches | lr 20.00 | ms/batch 36.00 | loss  0.16 | ppl     1.18
| epoch  17 |   600/ 3131 batches | lr 20.00 | ms/batch 36.06 | loss  0.17 | ppl     1.18
| epoch  17 |   800/ 3131 batches | lr 20.00 | ms/batch 36.26 | loss  0.17 | ppl     1.19
| epoch  17 |  1000/ 3131 batches | lr 20.00 | ms/batch 36.32 | loss  0.16 | ppl     1.18
| epoch  17 |  1200/ 3131 batches | lr 20.00 | ms/batch 36.39 | loss  0.15 | ppl     1.16
| epoch  17 |  1400/ 3131 batches | lr 20.00 | ms/batch 37.09 | loss  0.17 | ppl     1.18
| epoch  17 |  1600/ 3131 batches | lr 20.00 | ms/batch 37.65 | loss  0.19 | ppl     1.21
| epoch  17 |  1800/ 3131 batches | lr 20.00 | ms/batch 36.82 | loss  0.17 | ppl     1.19
| epoch  17 |  2000/ 3131 batches | lr 20.00 | ms/batch 37.04 | loss  0.16 | ppl     1.17
| epoch  17 |  2200/ 3131 batches | lr 20.00 | ms/batch 37.24 | loss  0.16 | ppl     1.17
| epoch  17 |  2400/ 3131 batches | lr 20.00 | ms/batch 37.54 | loss  0.18 | ppl     1.19
| epoch  17 |  2600/ 3131 batches | lr 20.00 | ms/batch 36.52 | loss  0.18 | ppl     1.20
| epoch  17 |  2800/ 3131 batches | lr 20.00 | ms/batch 36.52 | loss  0.15 | ppl     1.16
| epoch  17 |  3000/ 3131 batches | lr 20.00 | ms/batch 38.13 | loss  0.15 | ppl     1.17
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 120.55s | valid loss  0.29 | valid ppl     1.34
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 3131 batches | lr 5.00 | ms/batch 37.63 | loss  0.17 | ppl     1.19
| epoch  18 |   400/ 3131 batches | lr 5.00 | ms/batch 37.02 | loss  0.16 | ppl     1.18
| epoch  18 |   600/ 3131 batches | lr 5.00 | ms/batch 36.55 | loss  0.16 | ppl     1.17
| epoch  18 |   800/ 3131 batches | lr 5.00 | ms/batch 36.60 | loss  0.16 | ppl     1.17
| epoch  18 |  1000/ 3131 batches | lr 5.00 | ms/batch 36.47 | loss  0.14 | ppl     1.15
| epoch  18 |  1200/ 3131 batches | lr 5.00 | ms/batch 36.36 | loss  0.13 | ppl     1.14
| epoch  18 |  1400/ 3131 batches | lr 5.00 | ms/batch 37.42 | loss  0.15 | ppl     1.16
| epoch  18 |  1600/ 3131 batches | lr 5.00 | ms/batch 36.62 | loss  0.16 | ppl     1.18
| epoch  18 |  1800/ 3131 batches | lr 5.00 | ms/batch 37.55 | loss  0.15 | ppl     1.16
| epoch  18 |  2000/ 3131 batches | lr 5.00 | ms/batch 36.59 | loss  0.13 | ppl     1.14
| epoch  18 |  2200/ 3131 batches | lr 5.00 | ms/batch 37.13 | loss  0.14 | ppl     1.15
| epoch  18 |  2400/ 3131 batches | lr 5.00 | ms/batch 36.93 | loss  0.15 | ppl     1.16
| epoch  18 |  2600/ 3131 batches | lr 5.00 | ms/batch 36.76 | loss  0.14 | ppl     1.15
| epoch  18 |  2800/ 3131 batches | lr 5.00 | ms/batch 36.79 | loss  0.12 | ppl     1.12
| epoch  18 |  3000/ 3131 batches | lr 5.00 | ms/batch 36.50 | loss  0.12 | ppl     1.12
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 121.26s | valid loss  0.22 | valid ppl     1.24
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 3131 batches | lr 5.00 | ms/batch 36.34 | loss  0.14 | ppl     1.15
| epoch  19 |   400/ 3131 batches | lr 5.00 | ms/batch 36.36 | loss  0.14 | ppl     1.15
| epoch  19 |   600/ 3131 batches | lr 5.00 | ms/batch 36.52 | loss  0.14 | ppl     1.15
| epoch  19 |   800/ 3131 batches | lr 5.00 | ms/batch 37.33 | loss  0.14 | ppl     1.15
| epoch  19 |  1000/ 3131 batches | lr 5.00 | ms/batch 37.02 | loss  0.12 | ppl     1.13
| epoch  19 |  1200/ 3131 batches | lr 5.00 | ms/batch 36.85 | loss  0.11 | ppl     1.12
| epoch  19 |  1400/ 3131 batches | lr 5.00 | ms/batch 36.47 | loss  0.13 | ppl     1.14
| epoch  19 |  1600/ 3131 batches | lr 5.00 | ms/batch 36.74 | loss  0.15 | ppl     1.16
| epoch  19 |  1800/ 3131 batches | lr 5.00 | ms/batch 36.36 | loss  0.14 | ppl     1.14
| epoch  19 |  2000/ 3131 batches | lr 5.00 | ms/batch 36.40 | loss  0.12 | ppl     1.13
| epoch  19 |  2200/ 3131 batches | lr 5.00 | ms/batch 37.01 | loss  0.12 | ppl     1.13
| epoch  19 |  2400/ 3131 batches | lr 5.00 | ms/batch 36.58 | loss  0.13 | ppl     1.14
| epoch  19 |  2600/ 3131 batches | lr 5.00 | ms/batch 36.61 | loss  0.13 | ppl     1.14
| epoch  19 |  2800/ 3131 batches | lr 5.00 | ms/batch 37.00 | loss  0.11 | ppl     1.12
| epoch  19 |  3000/ 3131 batches | lr 5.00 | ms/batch 37.04 | loss  0.11 | ppl     1.11
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 120.86s | valid loss  0.20 | valid ppl     1.22
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 3131 batches | lr 5.00 | ms/batch 36.58 | loss  0.13 | ppl     1.14
| epoch  20 |   400/ 3131 batches | lr 5.00 | ms/batch 36.46 | loss  0.13 | ppl     1.14
| epoch  20 |   600/ 3131 batches | lr 5.00 | ms/batch 36.27 | loss  0.13 | ppl     1.14
| epoch  20 |   800/ 3131 batches | lr 5.00 | ms/batch 36.95 | loss  0.13 | ppl     1.14
| epoch  20 |  1000/ 3131 batches | lr 5.00 | ms/batch 36.42 | loss  0.12 | ppl     1.12
| epoch  20 |  1200/ 3131 batches | lr 5.00 | ms/batch 36.25 | loss  0.11 | ppl     1.11
| epoch  20 |  1400/ 3131 batches | lr 5.00 | ms/batch 36.66 | loss  0.12 | ppl     1.13
| epoch  20 |  1600/ 3131 batches | lr 5.00 | ms/batch 36.60 | loss  0.14 | ppl     1.15
| epoch  20 |  1800/ 3131 batches | lr 5.00 | ms/batch 36.49 | loss  0.12 | ppl     1.13
| epoch  20 |  2000/ 3131 batches | lr 5.00 | ms/batch 36.61 | loss  0.11 | ppl     1.12
| epoch  20 |  2200/ 3131 batches | lr 5.00 | ms/batch 36.45 | loss  0.11 | ppl     1.12
| epoch  20 |  2400/ 3131 batches | lr 5.00 | ms/batch 36.63 | loss  0.13 | ppl     1.13
| epoch  20 |  2600/ 3131 batches | lr 5.00 | ms/batch 36.41 | loss  0.12 | ppl     1.13
| epoch  20 |  2800/ 3131 batches | lr 5.00 | ms/batch 36.46 | loss  0.10 | ppl     1.11
| epoch  20 |  3000/ 3131 batches | lr 5.00 | ms/batch 36.65 | loss  0.10 | ppl     1.11
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 120.15s | valid loss  0.19 | valid ppl     1.21
-----------------------------------------------------------------------------------------
=========================================================================================
| End of training | test loss  0.16 | test ppl     1.17
=========================================================================================
Creating stacked model None
Traceback (most recent call last):
  File "main.py", line 266, in <module>
    corpus = data.Corpus(args.data, language)
  File "/home/schfrst2/creole_nn/creole/neural_stacking/data.py", line 66, in __init__
    self.pretrained = self.add_pretrained(os.path.join(path, 'wiki.' + language + '.vec'))
  File "/home/schfrst2/creole_nn/creole/neural_stacking/data.py", line 73, in add_pretrained
    assert os.path.exists(path)
AssertionError
