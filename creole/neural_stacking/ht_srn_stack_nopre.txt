Finetuning model on ht
| epoch   1 |   200/ 3131 batches | lr 20.00 | ms/batch 57.97 | loss  4.64 | ppl   103.09
| epoch   1 |   400/ 3131 batches | lr 20.00 | ms/batch 33.72 | loss  1.99 | ppl     7.32
| epoch   1 |   600/ 3131 batches | lr 20.00 | ms/batch 33.82 | loss  1.82 | ppl     6.14
| epoch   1 |   800/ 3131 batches | lr 20.00 | ms/batch 33.79 | loss  1.77 | ppl     5.88
| epoch   1 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.46 | loss  1.64 | ppl     5.14
| epoch   1 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.31 | loss  1.36 | ppl     3.89
| epoch   1 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.03 | loss  1.57 | ppl     4.83
| epoch   1 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.05 | loss  1.61 | ppl     5.00
| epoch   1 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.07 | loss  1.55 | ppl     4.72
| epoch   1 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.20 | loss  1.35 | ppl     3.85
| epoch   1 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.24 | loss  1.27 | ppl     3.56
| epoch   1 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.31 | loss  1.34 | ppl     3.81
| epoch   1 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.29 | loss  1.35 | ppl     3.85
| epoch   1 |  2800/ 3131 batches | lr 20.00 | ms/batch 34.42 | loss  1.18 | ppl     3.26
| epoch   1 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.81 | loss  1.23 | ppl     3.44
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 117.46s | valid loss  1.55 | valid ppl     4.72
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 3131 batches | lr 20.00 | ms/batch 35.37 | loss  1.29 | ppl     3.62
| epoch   2 |   400/ 3131 batches | lr 20.00 | ms/batch 34.74 | loss  1.15 | ppl     3.17
| epoch   2 |   600/ 3131 batches | lr 20.00 | ms/batch 34.38 | loss  1.11 | ppl     3.04
| epoch   2 |   800/ 3131 batches | lr 20.00 | ms/batch 34.48 | loss  1.15 | ppl     3.17
| epoch   2 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.29 | loss  1.09 | ppl     2.97
| epoch   2 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.34 | loss  0.91 | ppl     2.49
| epoch   2 |  1400/ 3131 batches | lr 20.00 | ms/batch 35.18 | loss  1.09 | ppl     2.97
| epoch   2 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.53 | loss  1.16 | ppl     3.18
| epoch   2 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.62 | loss  1.13 | ppl     3.08
| epoch   2 |  2000/ 3131 batches | lr 20.00 | ms/batch 35.17 | loss  1.00 | ppl     2.71
| epoch   2 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.49 | loss  0.92 | ppl     2.51
| epoch   2 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.61 | loss  1.00 | ppl     2.71
| epoch   2 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.09 | loss  1.00 | ppl     2.71
| epoch   2 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.21 | loss  0.86 | ppl     2.36
| epoch   2 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.54 | loss  0.93 | ppl     2.53
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 114.57s | valid loss  1.18 | valid ppl     3.27
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 3131 batches | lr 20.00 | ms/batch 34.62 | loss  0.99 | ppl     2.68
| epoch   3 |   400/ 3131 batches | lr 20.00 | ms/batch 34.38 | loss  0.90 | ppl     2.46
| epoch   3 |   600/ 3131 batches | lr 20.00 | ms/batch 34.47 | loss  0.87 | ppl     2.38
| epoch   3 |   800/ 3131 batches | lr 20.00 | ms/batch 35.00 | loss  0.91 | ppl     2.48
| epoch   3 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.46 | loss  0.86 | ppl     2.37
| epoch   3 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.46 | loss  0.73 | ppl     2.07
| epoch   3 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.67 | loss  0.88 | ppl     2.40
| epoch   3 |  1600/ 3131 batches | lr 20.00 | ms/batch 35.84 | loss  0.95 | ppl     2.58
| epoch   3 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.63 | loss  0.92 | ppl     2.51
| epoch   3 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.80 | loss  0.82 | ppl     2.27
| epoch   3 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.87 | loss  0.75 | ppl     2.12
| epoch   3 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.92 | loss  0.82 | ppl     2.27
| epoch   3 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.53 | loss  0.81 | ppl     2.26
| epoch   3 |  2800/ 3131 batches | lr 20.00 | ms/batch 34.48 | loss  0.69 | ppl     1.99
| epoch   3 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.43 | loss  0.76 | ppl     2.13
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 114.04s | valid loss  0.97 | valid ppl     2.64
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 3131 batches | lr 20.00 | ms/batch 34.50 | loss  0.80 | ppl     2.23
| epoch   4 |   400/ 3131 batches | lr 20.00 | ms/batch 34.32 | loss  0.74 | ppl     2.10
| epoch   4 |   600/ 3131 batches | lr 20.00 | ms/batch 34.43 | loss  0.71 | ppl     2.04
| epoch   4 |   800/ 3131 batches | lr 20.00 | ms/batch 34.34 | loss  0.75 | ppl     2.12
| epoch   4 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.58 | loss  0.71 | ppl     2.04
| epoch   4 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.72 | loss  0.60 | ppl     1.83
| epoch   4 |  1400/ 3131 batches | lr 20.00 | ms/batch 35.34 | loss  0.73 | ppl     2.08
| epoch   4 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.52 | loss  0.80 | ppl     2.24
| epoch   4 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.74 | loss  0.78 | ppl     2.18
| epoch   4 |  2000/ 3131 batches | lr 20.00 | ms/batch 35.91 | loss  0.69 | ppl     2.00
| epoch   4 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.60 | loss  0.63 | ppl     1.89
| epoch   4 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.64 | loss  0.70 | ppl     2.01
| epoch   4 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.51 | loss  0.69 | ppl     1.99
| epoch   4 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.02 | loss  0.58 | ppl     1.78
| epoch   4 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.73 | loss  0.64 | ppl     1.89
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 114.15s | valid loss  0.83 | valid ppl     2.29
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 3131 batches | lr 20.00 | ms/batch 34.36 | loss  0.67 | ppl     1.96
| epoch   5 |   400/ 3131 batches | lr 20.00 | ms/batch 34.48 | loss  0.63 | ppl     1.88
| epoch   5 |   600/ 3131 batches | lr 20.00 | ms/batch 34.43 | loss  0.60 | ppl     1.82
| epoch   5 |   800/ 3131 batches | lr 20.00 | ms/batch 34.44 | loss  0.63 | ppl     1.89
| epoch   5 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.49 | loss  0.60 | ppl     1.83
| epoch   5 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.07 | loss  0.51 | ppl     1.66
| epoch   5 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.30 | loss  0.63 | ppl     1.87
| epoch   5 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.47 | loss  0.69 | ppl     2.00
| epoch   5 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.49 | loss  0.67 | ppl     1.95
| epoch   5 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.52 | loss  0.60 | ppl     1.82
| epoch   5 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.42 | loss  0.55 | ppl     1.73
| epoch   5 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.50 | loss  0.61 | ppl     1.83
| epoch   5 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.49 | loss  0.60 | ppl     1.82
| epoch   5 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.52 | loss  0.50 | ppl     1.65
| epoch   5 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.46 | loss  0.55 | ppl     1.73
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 114.03s | valid loss  0.73 | valid ppl     2.08
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 3131 batches | lr 20.00 | ms/batch 34.73 | loss  0.57 | ppl     1.77
| epoch   6 |   400/ 3131 batches | lr 20.00 | ms/batch 34.51 | loss  0.53 | ppl     1.71
| epoch   6 |   600/ 3131 batches | lr 20.00 | ms/batch 34.34 | loss  0.51 | ppl     1.66
| epoch   6 |   800/ 3131 batches | lr 20.00 | ms/batch 34.31 | loss  0.54 | ppl     1.71
| epoch   6 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.29 | loss  0.51 | ppl     1.67
| epoch   6 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.53 | loss  0.44 | ppl     1.55
| epoch   6 |  1400/ 3131 batches | lr 20.00 | ms/batch 36.01 | loss  0.54 | ppl     1.72
| epoch   6 |  1600/ 3131 batches | lr 20.00 | ms/batch 36.07 | loss  0.61 | ppl     1.84
| epoch   6 |  1800/ 3131 batches | lr 20.00 | ms/batch 35.17 | loss  0.58 | ppl     1.79
| epoch   6 |  2000/ 3131 batches | lr 20.00 | ms/batch 35.81 | loss  0.52 | ppl     1.68
| epoch   6 |  2200/ 3131 batches | lr 20.00 | ms/batch 36.14 | loss  0.48 | ppl     1.61
| epoch   6 |  2400/ 3131 batches | lr 20.00 | ms/batch 35.55 | loss  0.53 | ppl     1.70
| epoch   6 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.58 | loss  0.53 | ppl     1.69
| epoch   6 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.55 | loss  0.43 | ppl     1.54
| epoch   6 |  3000/ 3131 batches | lr 20.00 | ms/batch 35.37 | loss  0.47 | ppl     1.60
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 116.07s | valid loss  0.65 | valid ppl     1.92
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 3131 batches | lr 20.00 | ms/batch 35.13 | loss  0.49 | ppl     1.63
| epoch   7 |   400/ 3131 batches | lr 20.00 | ms/batch 34.62 | loss  0.46 | ppl     1.58
| epoch   7 |   600/ 3131 batches | lr 20.00 | ms/batch 34.45 | loss  0.44 | ppl     1.55
| epoch   7 |   800/ 3131 batches | lr 20.00 | ms/batch 34.99 | loss  0.47 | ppl     1.59
| epoch   7 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.40 | loss  0.44 | ppl     1.56
| epoch   7 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.69 | loss  0.38 | ppl     1.46
| epoch   7 |  1400/ 3131 batches | lr 20.00 | ms/batch 35.49 | loss  0.47 | ppl     1.60
| epoch   7 |  1600/ 3131 batches | lr 20.00 | ms/batch 35.50 | loss  0.53 | ppl     1.70
| epoch   7 |  1800/ 3131 batches | lr 20.00 | ms/batch 35.74 | loss  0.50 | ppl     1.66
| epoch   7 |  2000/ 3131 batches | lr 20.00 | ms/batch 35.56 | loss  0.45 | ppl     1.57
| epoch   7 |  2200/ 3131 batches | lr 20.00 | ms/batch 35.16 | loss  0.42 | ppl     1.52
| epoch   7 |  2400/ 3131 batches | lr 20.00 | ms/batch 35.35 | loss  0.47 | ppl     1.60
| epoch   7 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.16 | loss  0.46 | ppl     1.59
| epoch   7 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.01 | loss  0.38 | ppl     1.46
| epoch   7 |  3000/ 3131 batches | lr 20.00 | ms/batch 36.41 | loss  0.41 | ppl     1.51
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 115.84s | valid loss  0.58 | valid ppl     1.78
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 3131 batches | lr 20.00 | ms/batch 35.45 | loss  0.42 | ppl     1.52
| epoch   8 |   400/ 3131 batches | lr 20.00 | ms/batch 35.41 | loss  0.39 | ppl     1.48
| epoch   8 |   600/ 3131 batches | lr 20.00 | ms/batch 35.59 | loss  0.38 | ppl     1.46
| epoch   8 |   800/ 3131 batches | lr 20.00 | ms/batch 36.01 | loss  0.40 | ppl     1.50
| epoch   8 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.52 | loss  0.38 | ppl     1.47
| epoch   8 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.17 | loss  0.33 | ppl     1.39
| epoch   8 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.29 | loss  0.41 | ppl     1.51
| epoch   8 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.62 | loss  0.47 | ppl     1.59
| epoch   8 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.39 | loss  0.44 | ppl     1.56
| epoch   8 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.69 | loss  0.40 | ppl     1.49
| epoch   8 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.37 | loss  0.37 | ppl     1.44
| epoch   8 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.31 | loss  0.42 | ppl     1.52
| epoch   8 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.19 | loss  0.41 | ppl     1.51
| epoch   8 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.76 | loss  0.34 | ppl     1.40
| epoch   8 |  3000/ 3131 batches | lr 20.00 | ms/batch 35.36 | loss  0.36 | ppl     1.43
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 115.48s | valid loss  0.52 | valid ppl     1.68
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 3131 batches | lr 20.00 | ms/batch 34.53 | loss  0.37 | ppl     1.44
| epoch   9 |   400/ 3131 batches | lr 20.00 | ms/batch 34.41 | loss  0.34 | ppl     1.41
| epoch   9 |   600/ 3131 batches | lr 20.00 | ms/batch 34.38 | loss  0.33 | ppl     1.39
| epoch   9 |   800/ 3131 batches | lr 20.00 | ms/batch 35.45 | loss  0.35 | ppl     1.42
| epoch   9 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.00 | loss  0.34 | ppl     1.40
| epoch   9 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.53 | loss  0.29 | ppl     1.34
| epoch   9 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.52 | loss  0.36 | ppl     1.43
| epoch   9 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.54 | loss  0.41 | ppl     1.51
| epoch   9 |  1800/ 3131 batches | lr 20.00 | ms/batch 35.15 | loss  0.39 | ppl     1.47
| epoch   9 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.70 | loss  0.35 | ppl     1.42
| epoch   9 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.57 | loss  0.33 | ppl     1.39
| epoch   9 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.47 | loss  0.37 | ppl     1.45
| epoch   9 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.90 | loss  0.36 | ppl     1.44
| epoch   9 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.96 | loss  0.30 | ppl     1.35
| epoch   9 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.66 | loss  0.32 | ppl     1.37
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 114.32s | valid loss  0.47 | valid ppl     1.60
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 3131 batches | lr 20.00 | ms/batch 34.38 | loss  0.32 | ppl     1.38
| epoch  10 |   400/ 3131 batches | lr 20.00 | ms/batch 34.17 | loss  0.30 | ppl     1.35
| epoch  10 |   600/ 3131 batches | lr 20.00 | ms/batch 34.38 | loss  0.29 | ppl     1.34
| epoch  10 |   800/ 3131 batches | lr 20.00 | ms/batch 34.55 | loss  0.31 | ppl     1.36
| epoch  10 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.93 | loss  0.29 | ppl     1.34
| epoch  10 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.35 | loss  0.26 | ppl     1.30
| epoch  10 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.65 | loss  0.32 | ppl     1.38
| epoch  10 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.47 | loss  0.37 | ppl     1.44
| epoch  10 |  1800/ 3131 batches | lr 20.00 | ms/batch 35.07 | loss  0.34 | ppl     1.41
| epoch  10 |  2000/ 3131 batches | lr 20.00 | ms/batch 36.75 | loss  0.31 | ppl     1.37
| epoch  10 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.41 | loss  0.29 | ppl     1.34
| epoch  10 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.94 | loss  0.33 | ppl     1.39
| epoch  10 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.26 | loss  0.33 | ppl     1.39
| epoch  10 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.51 | loss  0.27 | ppl     1.31
| epoch  10 |  3000/ 3131 batches | lr 20.00 | ms/batch 35.71 | loss  0.28 | ppl     1.32
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 115.09s | valid loss  0.44 | valid ppl     1.55
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 3131 batches | lr 20.00 | ms/batch 34.52 | loss  0.29 | ppl     1.33
| epoch  11 |   400/ 3131 batches | lr 20.00 | ms/batch 34.30 | loss  0.27 | ppl     1.31
| epoch  11 |   600/ 3131 batches | lr 20.00 | ms/batch 34.60 | loss  0.26 | ppl     1.30
| epoch  11 |   800/ 3131 batches | lr 20.00 | ms/batch 34.36 | loss  0.28 | ppl     1.32
| epoch  11 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.64 | loss  0.26 | ppl     1.30
| epoch  11 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.75 | loss  0.23 | ppl     1.26
| epoch  11 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.70 | loss  0.28 | ppl     1.33
| epoch  11 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.71 | loss  0.32 | ppl     1.38
| epoch  11 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.67 | loss  0.30 | ppl     1.35
| epoch  11 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.68 | loss  0.28 | ppl     1.32
| epoch  11 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.87 | loss  0.26 | ppl     1.30
| epoch  11 |  2400/ 3131 batches | lr 20.00 | ms/batch 35.50 | loss  0.30 | ppl     1.34
| epoch  11 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.77 | loss  0.29 | ppl     1.34
| epoch  11 |  2800/ 3131 batches | lr 20.00 | ms/batch 34.64 | loss  0.24 | ppl     1.28
| epoch  11 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.66 | loss  0.25 | ppl     1.28
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 114.20s | valid loss  0.39 | valid ppl     1.48
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 3131 batches | lr 20.00 | ms/batch 34.65 | loss  0.26 | ppl     1.29
| epoch  12 |   400/ 3131 batches | lr 20.00 | ms/batch 34.60 | loss  0.24 | ppl     1.27
| epoch  12 |   600/ 3131 batches | lr 20.00 | ms/batch 34.43 | loss  0.24 | ppl     1.27
| epoch  12 |   800/ 3131 batches | lr 20.00 | ms/batch 34.37 | loss  0.25 | ppl     1.28
| epoch  12 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.37 | loss  0.23 | ppl     1.26
| epoch  12 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.60 | loss  0.21 | ppl     1.23
| epoch  12 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.67 | loss  0.25 | ppl     1.29
| epoch  12 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.68 | loss  0.29 | ppl     1.34
| epoch  12 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.42 | loss  0.27 | ppl     1.31
| epoch  12 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.43 | loss  0.25 | ppl     1.28
| epoch  12 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.42 | loss  0.24 | ppl     1.27
| epoch  12 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.58 | loss  0.27 | ppl     1.31
| epoch  12 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.25 | loss  0.26 | ppl     1.30
| epoch  12 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.12 | loss  0.22 | ppl     1.25
| epoch  12 |  3000/ 3131 batches | lr 20.00 | ms/batch 35.56 | loss  0.23 | ppl     1.25
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 114.55s | valid loss  0.37 | valid ppl     1.45
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 3131 batches | lr 20.00 | ms/batch 34.97 | loss  0.23 | ppl     1.26
| epoch  13 |   400/ 3131 batches | lr 20.00 | ms/batch 34.56 | loss  0.22 | ppl     1.24
| epoch  13 |   600/ 3131 batches | lr 20.00 | ms/batch 34.40 | loss  0.22 | ppl     1.24
| epoch  13 |   800/ 3131 batches | lr 20.00 | ms/batch 34.70 | loss  0.22 | ppl     1.25
| epoch  13 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.35 | loss  0.21 | ppl     1.24
| epoch  13 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.53 | loss  0.19 | ppl     1.21
| epoch  13 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.64 | loss  0.23 | ppl     1.26
| epoch  13 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.77 | loss  0.26 | ppl     1.30
| epoch  13 |  1800/ 3131 batches | lr 20.00 | ms/batch 35.27 | loss  0.24 | ppl     1.27
| epoch  13 |  2000/ 3131 batches | lr 20.00 | ms/batch 35.67 | loss  0.22 | ppl     1.25
| epoch  13 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.68 | loss  0.22 | ppl     1.24
| epoch  13 |  2400/ 3131 batches | lr 20.00 | ms/batch 35.00 | loss  0.24 | ppl     1.28
| epoch  13 |  2600/ 3131 batches | lr 20.00 | ms/batch 35.18 | loss  0.24 | ppl     1.27
| epoch  13 |  2800/ 3131 batches | lr 20.00 | ms/batch 34.43 | loss  0.20 | ppl     1.22
| epoch  13 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.17 | loss  0.20 | ppl     1.23
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 114.11s | valid loss  0.34 | valid ppl     1.40
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 3131 batches | lr 20.00 | ms/batch 34.96 | loss  0.21 | ppl     1.24
| epoch  14 |   400/ 3131 batches | lr 20.00 | ms/batch 34.70 | loss  0.20 | ppl     1.22
| epoch  14 |   600/ 3131 batches | lr 20.00 | ms/batch 34.38 | loss  0.20 | ppl     1.23
| epoch  14 |   800/ 3131 batches | lr 20.00 | ms/batch 34.71 | loss  0.20 | ppl     1.23
| epoch  14 |  1000/ 3131 batches | lr 20.00 | ms/batch 34.54 | loss  0.19 | ppl     1.21
| epoch  14 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.11 | loss  0.18 | ppl     1.19
| epoch  14 |  1400/ 3131 batches | lr 20.00 | ms/batch 35.11 | loss  0.21 | ppl     1.23
| epoch  14 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.54 | loss  0.24 | ppl     1.27
| epoch  14 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.84 | loss  0.22 | ppl     1.25
| epoch  14 |  2000/ 3131 batches | lr 20.00 | ms/batch 35.44 | loss  0.20 | ppl     1.22
| epoch  14 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.12 | loss  0.20 | ppl     1.22
| epoch  14 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.53 | loss  0.22 | ppl     1.25
| epoch  14 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.63 | loss  0.22 | ppl     1.25
| epoch  14 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.02 | loss  0.18 | ppl     1.20
| epoch  14 |  3000/ 3131 batches | lr 20.00 | ms/batch 35.57 | loss  0.19 | ppl     1.20
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 114.45s | valid loss  0.32 | valid ppl     1.37
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 3131 batches | lr 20.00 | ms/batch 34.40 | loss  0.19 | ppl     1.21
| epoch  15 |   400/ 3131 batches | lr 20.00 | ms/batch 34.41 | loss  0.18 | ppl     1.20
| epoch  15 |   600/ 3131 batches | lr 20.00 | ms/batch 34.85 | loss  0.19 | ppl     1.20
| epoch  15 |   800/ 3131 batches | lr 20.00 | ms/batch 35.54 | loss  0.19 | ppl     1.21
| epoch  15 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.43 | loss  0.18 | ppl     1.20
| epoch  15 |  1200/ 3131 batches | lr 20.00 | ms/batch 35.53 | loss  0.16 | ppl     1.18
| epoch  15 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.94 | loss  0.19 | ppl     1.21
| epoch  15 |  1600/ 3131 batches | lr 20.00 | ms/batch 35.62 | loss  0.22 | ppl     1.24
| epoch  15 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.76 | loss  0.20 | ppl     1.22
| epoch  15 |  2000/ 3131 batches | lr 20.00 | ms/batch 35.13 | loss  0.19 | ppl     1.20
| epoch  15 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.35 | loss  0.18 | ppl     1.20
| epoch  15 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.47 | loss  0.20 | ppl     1.22
| epoch  15 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.86 | loss  0.20 | ppl     1.22
| epoch  15 |  2800/ 3131 batches | lr 20.00 | ms/batch 34.48 | loss  0.17 | ppl     1.18
| epoch  15 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.82 | loss  0.17 | ppl     1.19
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 114.77s | valid loss  0.31 | valid ppl     1.36
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 3131 batches | lr 20.00 | ms/batch 34.51 | loss  0.18 | ppl     1.20
| epoch  16 |   400/ 3131 batches | lr 20.00 | ms/batch 34.54 | loss  0.17 | ppl     1.19
| epoch  16 |   600/ 3131 batches | lr 20.00 | ms/batch 34.41 | loss  0.18 | ppl     1.19
| epoch  16 |   800/ 3131 batches | lr 20.00 | ms/batch 35.22 | loss  0.18 | ppl     1.20
| epoch  16 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.47 | loss  0.17 | ppl     1.19
| epoch  16 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.45 | loss  0.16 | ppl     1.17/home/schfrst2/creole_nn/creole/neural_stacking/model.py:54: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greately increasing memory usage. To compact weights again call flatten_parameters().
  output, hidden = self.rnn(emb, hidden)
/home/schfrst2/creole_nn/creole/neural_stacking/model.py:135: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greately increasing memory usage. To compact weights again call flatten_parameters().
  output, hidden = self.rnn_bottom(emb, hidden)
/home/schfrst2/creole_nn/creole/neural_stacking/model.py:150: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greately increasing memory usage. To compact weights again call flatten_parameters().
  output, hidden = self.rnn_top(new_emb, hidden)

| epoch  16 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.35 | loss  0.18 | ppl     1.20
| epoch  16 |  1600/ 3131 batches | lr 20.00 | ms/batch 34.60 | loss  0.20 | ppl     1.22
| epoch  16 |  1800/ 3131 batches | lr 20.00 | ms/batch 34.82 | loss  0.19 | ppl     1.20
| epoch  16 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.74 | loss  0.17 | ppl     1.18
| epoch  16 |  2200/ 3131 batches | lr 20.00 | ms/batch 34.62 | loss  0.17 | ppl     1.18
| epoch  16 |  2400/ 3131 batches | lr 20.00 | ms/batch 36.38 | loss  0.19 | ppl     1.21
| epoch  16 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.97 | loss  0.19 | ppl     1.21
| epoch  16 |  2800/ 3131 batches | lr 20.00 | ms/batch 35.26 | loss  0.16 | ppl     1.18
| epoch  16 |  3000/ 3131 batches | lr 20.00 | ms/batch 35.37 | loss  0.16 | ppl     1.17
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 114.70s | valid loss  0.28 | valid ppl     1.33
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 3131 batches | lr 20.00 | ms/batch 34.52 | loss  0.17 | ppl     1.19
| epoch  17 |   400/ 3131 batches | lr 20.00 | ms/batch 34.43 | loss  0.16 | ppl     1.18
| epoch  17 |   600/ 3131 batches | lr 20.00 | ms/batch 34.33 | loss  0.17 | ppl     1.18
| epoch  17 |   800/ 3131 batches | lr 20.00 | ms/batch 35.56 | loss  0.17 | ppl     1.19
| epoch  17 |  1000/ 3131 batches | lr 20.00 | ms/batch 35.86 | loss  0.16 | ppl     1.18
| epoch  17 |  1200/ 3131 batches | lr 20.00 | ms/batch 34.59 | loss  0.15 | ppl     1.16
| epoch  17 |  1400/ 3131 batches | lr 20.00 | ms/batch 34.79 | loss  0.17 | ppl     1.18
| epoch  17 |  1600/ 3131 batches | lr 20.00 | ms/batch 37.02 | loss  0.19 | ppl     1.21
| epoch  17 |  1800/ 3131 batches | lr 20.00 | ms/batch 35.35 | loss  0.17 | ppl     1.19
| epoch  17 |  2000/ 3131 batches | lr 20.00 | ms/batch 34.76 | loss  0.16 | ppl     1.17
| epoch  17 |  2200/ 3131 batches | lr 20.00 | ms/batch 35.22 | loss  0.16 | ppl     1.17
| epoch  17 |  2400/ 3131 batches | lr 20.00 | ms/batch 34.86 | loss  0.18 | ppl     1.19
| epoch  17 |  2600/ 3131 batches | lr 20.00 | ms/batch 34.39 | loss  0.18 | ppl     1.20
| epoch  17 |  2800/ 3131 batches | lr 20.00 | ms/batch 34.33 | loss  0.15 | ppl     1.16
| epoch  17 |  3000/ 3131 batches | lr 20.00 | ms/batch 34.75 | loss  0.15 | ppl     1.17
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 114.98s | valid loss  0.29 | valid ppl     1.34
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 3131 batches | lr 5.00 | ms/batch 35.18 | loss  0.17 | ppl     1.19
| epoch  18 |   400/ 3131 batches | lr 5.00 | ms/batch 34.54 | loss  0.16 | ppl     1.18
| epoch  18 |   600/ 3131 batches | lr 5.00 | ms/batch 34.49 | loss  0.16 | ppl     1.17
| epoch  18 |   800/ 3131 batches | lr 5.00 | ms/batch 34.48 | loss  0.16 | ppl     1.17
| epoch  18 |  1000/ 3131 batches | lr 5.00 | ms/batch 34.56 | loss  0.14 | ppl     1.15
| epoch  18 |  1200/ 3131 batches | lr 5.00 | ms/batch 34.74 | loss  0.13 | ppl     1.14
| epoch  18 |  1400/ 3131 batches | lr 5.00 | ms/batch 34.58 | loss  0.15 | ppl     1.16
| epoch  18 |  1600/ 3131 batches | lr 5.00 | ms/batch 34.45 | loss  0.16 | ppl     1.18
| epoch  18 |  1800/ 3131 batches | lr 5.00 | ms/batch 34.41 | loss  0.15 | ppl     1.16
| epoch  18 |  2000/ 3131 batches | lr 5.00 | ms/batch 34.60 | loss  0.13 | ppl     1.14
| epoch  18 |  2200/ 3131 batches | lr 5.00 | ms/batch 34.57 | loss  0.14 | ppl     1.15
| epoch  18 |  2400/ 3131 batches | lr 5.00 | ms/batch 35.95 | loss  0.15 | ppl     1.16
| epoch  18 |  2600/ 3131 batches | lr 5.00 | ms/batch 35.25 | loss  0.14 | ppl     1.15
| epoch  18 |  2800/ 3131 batches | lr 5.00 | ms/batch 34.19 | loss  0.12 | ppl     1.12
| epoch  18 |  3000/ 3131 batches | lr 5.00 | ms/batch 34.48 | loss  0.12 | ppl     1.12
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 114.26s | valid loss  0.22 | valid ppl     1.24
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 3131 batches | lr 5.00 | ms/batch 34.76 | loss  0.14 | ppl     1.15
| epoch  19 |   400/ 3131 batches | lr 5.00 | ms/batch 34.79 | loss  0.14 | ppl     1.15
| epoch  19 |   600/ 3131 batches | lr 5.00 | ms/batch 34.66 | loss  0.14 | ppl     1.15
| epoch  19 |   800/ 3131 batches | lr 5.00 | ms/batch 35.03 | loss  0.14 | ppl     1.15
| epoch  19 |  1000/ 3131 batches | lr 5.00 | ms/batch 34.48 | loss  0.12 | ppl     1.13
| epoch  19 |  1200/ 3131 batches | lr 5.00 | ms/batch 34.36 | loss  0.11 | ppl     1.12
| epoch  19 |  1400/ 3131 batches | lr 5.00 | ms/batch 34.48 | loss  0.13 | ppl     1.14
| epoch  19 |  1600/ 3131 batches | lr 5.00 | ms/batch 34.79 | loss  0.15 | ppl     1.16
| epoch  19 |  1800/ 3131 batches | lr 5.00 | ms/batch 34.78 | loss  0.14 | ppl     1.14
| epoch  19 |  2000/ 3131 batches | lr 5.00 | ms/batch 34.53 | loss  0.12 | ppl     1.13
| epoch  19 |  2200/ 3131 batches | lr 5.00 | ms/batch 34.77 | loss  0.12 | ppl     1.13
| epoch  19 |  2400/ 3131 batches | lr 5.00 | ms/batch 36.36 | loss  0.13 | ppl     1.14
| epoch  19 |  2600/ 3131 batches | lr 5.00 | ms/batch 34.46 | loss  0.13 | ppl     1.14
| epoch  19 |  2800/ 3131 batches | lr 5.00 | ms/batch 34.49 | loss  0.11 | ppl     1.12
| epoch  19 |  3000/ 3131 batches | lr 5.00 | ms/batch 34.49 | loss  0.11 | ppl     1.11
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 114.16s | valid loss  0.20 | valid ppl     1.22
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 3131 batches | lr 5.00 | ms/batch 34.54 | loss  0.13 | ppl     1.14
| epoch  20 |   400/ 3131 batches | lr 5.00 | ms/batch 34.32 | loss  0.13 | ppl     1.14
| epoch  20 |   600/ 3131 batches | lr 5.00 | ms/batch 34.15 | loss  0.13 | ppl     1.14
| epoch  20 |   800/ 3131 batches | lr 5.00 | ms/batch 34.64 | loss  0.13 | ppl     1.14
| epoch  20 |  1000/ 3131 batches | lr 5.00 | ms/batch 34.32 | loss  0.12 | ppl     1.12
| epoch  20 |  1200/ 3131 batches | lr 5.00 | ms/batch 34.45 | loss  0.11 | ppl     1.11
| epoch  20 |  1400/ 3131 batches | lr 5.00 | ms/batch 34.34 | loss  0.12 | ppl     1.13
| epoch  20 |  1600/ 3131 batches | lr 5.00 | ms/batch 34.50 | loss  0.14 | ppl     1.15
| epoch  20 |  1800/ 3131 batches | lr 5.00 | ms/batch 34.47 | loss  0.12 | ppl     1.13
| epoch  20 |  2000/ 3131 batches | lr 5.00 | ms/batch 36.10 | loss  0.11 | ppl     1.12
| epoch  20 |  2200/ 3131 batches | lr 5.00 | ms/batch 35.01 | loss  0.11 | ppl     1.12
| epoch  20 |  2400/ 3131 batches | lr 5.00 | ms/batch 34.75 | loss  0.13 | ppl     1.13
| epoch  20 |  2600/ 3131 batches | lr 5.00 | ms/batch 35.16 | loss  0.12 | ppl     1.13
| epoch  20 |  2800/ 3131 batches | lr 5.00 | ms/batch 35.54 | loss  0.10 | ppl     1.11
| epoch  20 |  3000/ 3131 batches | lr 5.00 | ms/batch 35.54 | loss  0.10 | ppl     1.11
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 114.50s | valid loss  0.19 | valid ppl     1.21
-----------------------------------------------------------------------------------------
=========================================================================================
| End of training | test loss  0.16 | test ppl     1.17
=========================================================================================
Creating stacked model None
-----------------------------------------------------------------------------------------
| end of epoch   1 | time:  4.71s | valid loss  5.71 | valid ppl   302.35
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   2 | time:  4.12s | valid loss  4.00 | valid ppl    54.53
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   3 | time:  4.08s | valid loss  3.15 | valid ppl    23.22
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   4 | time:  4.07s | valid loss  3.01 | valid ppl    20.21
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   5 | time:  4.12s | valid loss  2.94 | valid ppl    18.99
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   6 | time:  4.08s | valid loss  2.95 | valid ppl    19.15
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   7 | time:  4.04s | valid loss  2.94 | valid ppl    18.91
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   8 | time:  4.10s | valid loss  2.93 | valid ppl    18.76
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   9 | time:  4.07s | valid loss  2.94 | valid ppl    18.87
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  10 | time:  4.07s | valid loss  2.94 | valid ppl    18.83
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  11 | time:  4.05s | valid loss  2.93 | valid ppl    18.66
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  12 | time:  4.07s | valid loss  2.92 | valid ppl    18.61
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  13 | time:  4.08s | valid loss  2.93 | valid ppl    18.64
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  14 | time:  4.10s | valid loss  2.92 | valid ppl    18.60
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  15 | time:  4.08s | valid loss  2.92 | valid ppl    18.55
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  16 | time:  4.07s | valid loss  2.92 | valid ppl    18.56
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  17 | time:  4.06s | valid loss  2.92 | valid ppl    18.55
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  18 | time:  4.09s | valid loss  2.92 | valid ppl    18.55
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  19 | time:  4.10s | valid loss  2.92 | valid ppl    18.55
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  20 | time:  4.22s | valid loss  2.92 | valid ppl    18.55
-----------------------------------------------------------------------------------------
=========================================================================================
| End of training | test loss  4.11 | test ppl    61.18
=========================================================================================
